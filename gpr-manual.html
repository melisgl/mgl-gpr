<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
<head>
<title>GPR Manual</title>
<link type='text/css' href='style.css' rel='stylesheet'/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<script src="jquery.min.js"></script>
<script src="toc.min.js"></script>
<script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       tex2jax: {
         inlineMath: [['$','$']],
         processEscapes: true
       }
     });
   </script>
   <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
   </script>
   </head>
<body>
<div id="content-container">
<div id="toc">
<div id="page-toc">
</div>
<div id="toc-footer"><ul><li><a href="https://github.com/melisgl/mgl-pax">[generated by MGL-PAX]</a></li></ul></div>
</div>
<div id="content">
<p><a id='x-28MGL-GPR-3A-40GPR-MANUAL-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28-23A-28-287-29-20BASE-CHAR-20-2E-20-22mgl-gpr-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(#A((7) BASE-CHAR . \&quot;mgl-gpr\&quot;) ASDF/SYSTEM:SYSTEM)">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-MANUAL-20MGL-PAX-3ASECTION-29" title="GPR Manual">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L3">&#955;</a></span></span></p>

<h1><a href="#x-28MGL-GPR-3A-40GPR-MANUAL-20MGL-PAX-3ASECTION-29">GPR Manual</a></h1>

<h2>Table of Contents</h2>

<ul>
<li><a href="#x-28-23A-28-287-29-20BASE-CHAR-20-2E-20-22mgl-gpr-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(#A((7) BASE-CHAR . \&quot;mgl-gpr\&quot;) ASDF/SYSTEM:SYSTEM)">1 MGL-GPR ASDF System Details</a></li>
<li><a href="#x-28MGL-GPR-3A-40GPR-GP-LINKS-20MGL-PAX-3ASECTION-29" title="Links">2 Links</a></li>
<li><a href="#x-28MGL-GPR-3A-40GPR-BACKGROUND-20MGL-PAX-3ASECTION-29" title="Background">3 Background</a></li>
<li><a href="#x-28MGL-GPR-3A-40GPR-EA-20MGL-PAX-3ASECTION-29" title="Evolutionary Algorithms">4 Evolutionary Algorithms</a>

<ul>
<li><a href="#x-28MGL-GPR-3A-40GPR-EA-POPULATION-20MGL-PAX-3ASECTION-29" title="Populations">4.1 Populations</a></li>
<li><a href="#x-28MGL-GPR-3A-40GPR-EA-EVALUATION-20MGL-PAX-3ASECTION-29" title="Evaluation">4.2 Evaluation</a></li>
<li><a href="#x-28MGL-GPR-3A-40GPR-EA-TRAINING-20MGL-PAX-3ASECTION-29" title="Training">4.3 Training</a></li>
</ul></li>
<li><a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29" title="Genetic Programming">5 Genetic Programming</a>

<ul>
<li><a href="#x-28MGL-GPR-3A-40GPR-GP-BACKGROUND-20MGL-PAX-3ASECTION-29" title="Background">5.1 Background</a></li>
<li><a href="#x-28MGL-GPR-3A-40GPR-GP-TUTORIAL-20MGL-PAX-3ASECTION-29" title="Tutorial">5.2 Tutorial</a></li>
<li><a href="#x-28MGL-GPR-3A-40GPR-GP-EXPRESSIONS-20MGL-PAX-3ASECTION-29" title="Expressions">5.3 Expressions</a></li>
<li><a href="#x-28MGL-GPR-3A-40GPR-GP-BASICS-20MGL-PAX-3ASECTION-29" title="Basics">5.4 Basics</a></li>
<li><a href="#x-28MGL-GPR-3A-40GPR-GP-SEARCH-SPACE-20MGL-PAX-3ASECTION-29" title="Search Space">5.5 Search Space</a></li>
<li><a href="#x-28MGL-GPR-3A-40GPR-GP-REPRODUCTION-20MGL-PAX-3ASECTION-29" title="Reproduction">5.6 Reproduction</a></li>
<li><a href="#x-28MGL-GPR-3A-40GPR-GP-ENVIRONMENT-20MGL-PAX-3ASECTION-29" title="Environment">5.7 Environment</a></li>
</ul></li>
<li><a href="#x-28MGL-GPR-3A-40GPR-DE-20MGL-PAX-3ASECTION-29" title="Differential Evolution">6 Differential Evolution</a>

<ul>
<li><a href="#x-28MGL-GPR-3A-40GPR-DE-SANSDE-20MGL-PAX-3ASECTION-29" title="SANSDE">6.1 SANSDE</a></li>
</ul></li>
</ul>

<h6>[in package MGL-GPR]</h6>

<p><a id='x-28-23A-28-287-29-20BASE-CHAR-20-2E-20-22mgl-gpr-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-MANUAL-20MGL-PAX-3ASECTION-29" title="GPR Manual">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-MANUAL-20MGL-PAX-3ASECTION-29" title="GPR Manual">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-LINKS-20MGL-PAX-3ASECTION-29" title="Links">&#8594;</a> <a href="#x-28-23A-28-287-29-20BASE-CHAR-20-2E-20-22mgl-gpr-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(#A((7) BASE-CHAR . \&quot;mgl-gpr\&quot;) ASDF/SYSTEM:SYSTEM)">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/mgl-gpr.asd#L1">&#955;</a></span></span></p>

<h2><a href="#x-28-23A-28-287-29-20BASE-CHAR-20-2E-20-22mgl-gpr-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29">1 MGL-GPR ASDF System Details</a></h2>

<ul>
<li>Version: 0.0.1</li>
<li>Description: <a href="#x-28-23A-28-287-29-20BASE-CHAR-20-2E-20-22mgl-gpr-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(#A((7) BASE-CHAR . \&quot;mgl-gpr\&quot;) ASDF/SYSTEM:SYSTEM)"><code>MGL-GPR</code></a> is a library of evolutionary algorithms such
  as Genetic Programming (evolving typed expressions from a set of
  operators and constants) and Differential Evolution.</li>
<li>Licence: MIT, see COPYING.</li>
<li>Author: GÃ¡bor Melis <a href="m&#x61;&#105;l&#x74;&#111;:&#x6D;&#101;g&#x61;&#64;r&#x65;&#116;e&#x73;&#46;h&#x75;">m&#x61;&#105;l&#x74;&#111;:&#x6D;&#101;g&#x61;&#64;r&#x65;&#116;e&#x73;&#46;h&#x75;</a></li>
<li>Mailto: <a href="mailto:mega@retes.hu" >mega@retes.hu</a></li>
<li>Homepage: <a href="http://melisgl.github.io/mgl-gpr" >http://melisgl.github.io/mgl-gpr</a></li>
<li>Bug tracker: <a href="https://github.com/melisgl/mgl-gpr/issues" >https://github.com/melisgl/mgl-gpr/issues</a></li>
<li>Source control: <a href="https://github.com/melisgl/mgl-gpr.git" >GIT</a></li>
</ul>

<p><a id='x-28MGL-GPR-3A-40GPR-GP-LINKS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28-23A-28-287-29-20BASE-CHAR-20-2E-20-22mgl-gpr-22-29-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(#A((7) BASE-CHAR . \&quot;mgl-gpr\&quot;) ASDF/SYSTEM:SYSTEM)">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-MANUAL-20MGL-PAX-3ASECTION-29" title="GPR Manual">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-BACKGROUND-20MGL-PAX-3ASECTION-29" title="Background">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-LINKS-20MGL-PAX-3ASECTION-29" title="Links">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L11">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-GPR-3A-40GPR-GP-LINKS-20MGL-PAX-3ASECTION-29">2 Links</a></h2>

<p>Here is the <a href="https://github.com/melisgl/mgl-gpr" >official
repository</a> and the <a href="http://melisgl.github.io/mgl-gpr/gpr-manual.html" >HTML
documentation</a>
for the latest version.</p>

<p><a id='x-28MGL-GPR-3A-40GPR-BACKGROUND-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-GP-LINKS-20MGL-PAX-3ASECTION-29" title="Links">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-MANUAL-20MGL-PAX-3ASECTION-29" title="GPR Manual">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-EA-20MGL-PAX-3ASECTION-29" title="Evolutionary Algorithms">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-BACKGROUND-20MGL-PAX-3ASECTION-29" title="Background">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L17">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-GPR-3A-40GPR-BACKGROUND-20MGL-PAX-3ASECTION-29">3 Background</a></h2>

<p>Evolutionary algorithms are optimization tools that assume little
of the task at hand. Often they are population based, that is, there
is a set of individuals that each represent a candidate solution.
Individuals are combined and changed with crossover and mutationlike
operators to produce the next generation. Individuals with lower
fitness have a lower probability to survive than those with higher
fitness. In this way, the fitness function defines the optimization
task.</p>

<p>Typically, EAs are quick to get up and running, can produce
reasonable results across a wild variety of domains, but they may
need a bit of fiddling to perform well and domain specific
approaches will almost always have better results. All in all, EA
can be very useful to cut down on the tedium of human trial and
error. However, they have serious problems scaling to higher number
of variables.</p>

<p>This library grew from the Genetic Programming implementation I
wrote while working for Ravenpack who agreed to release it under an
MIT licence. Several years later I cleaned it up, and documented it.
Enjoy.</p>

<p><a id='x-28MGL-GPR-3A-40GPR-EA-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-BACKGROUND-20MGL-PAX-3ASECTION-29" title="Background">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-MANUAL-20MGL-PAX-3ASECTION-29" title="GPR Manual">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-EA-POPULATION-20MGL-PAX-3ASECTION-29" title="Populations">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-EA-20MGL-PAX-3ASECTION-29" title="Evolutionary Algorithms">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L40">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-GPR-3A-40GPR-EA-20MGL-PAX-3ASECTION-29">4 Evolutionary Algorithms</a></h2>

<p>Evolutionary algorithm is an umbrella term. In this section we
first discuss the concepts common to conrete evolutionary algorithms
<a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29" title="Genetic Programming">Genetic Programming</a> and <a href="#x-28MGL-GPR-3A-40GPR-DE-20MGL-PAX-3ASECTION-29" title="Differential Evolution">Differential Evolution</a>.</p>

<p><a id='x-28MGL-GPR-3AEVOLUTIONARY-ALGORITHM-20CLASS-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L84">[class]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AEVOLUTIONARY-ALGORITHM-20CLASS-29" >EVOLUTIONARY-ALGORITHM</a></span></span></span></p>

<p>The <code>EVOLUTIONARY-ALGORITHM</code> is an abstract base
class for generational, population based optimization algorithms.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3A-40GPR-EA-POPULATION-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-EA-20MGL-PAX-3ASECTION-29" title="Evolutionary Algorithms">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-EA-20MGL-PAX-3ASECTION-29" title="Evolutionary Algorithms">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-EA-EVALUATION-20MGL-PAX-3ASECTION-29" title="Evaluation">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-EA-POPULATION-20MGL-PAX-3ASECTION-29" title="Populations">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L49">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-GPR-3A-40GPR-EA-POPULATION-20MGL-PAX-3ASECTION-29">4.1 Populations</a></h3>

<p>The currenly implemented EAs are generational. That is, they
maintain a population of candidate solutions (also known as
individuals) which they replace with the next generation of
individuals.</p>

<p><a id='x-28MGL-GPR-3APOPULATION-SIZE-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L128">[accessor]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3APOPULATION-SIZE-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" >POPULATION-SIZE</a></span></span> <span class="locative-args">EVOLUTIONARY-ALGORITHM</span> <span class="locative-args">(:POPULATION-SIZE)</span></span></p>

<p>The number of individuals in a generation. This is
a very important parameter. Too low and there won't be enough
diversity in the population, too high and convergence will be
slow.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3APOPULATION-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L148">[accessor]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3APOPULATION-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" >POPULATION</a></span></span> <span class="locative-args">EVOLUTIONARY-ALGORITHM</span> <span class="locative-args">(= (<code>MAKE-ARRAY</code> 0 <code>:ADJUSTABLE</code> 0 <code>:FILL-POINTER</code> <code>T</code>))</span></span></p>

<p>An adjustable array with a fill-pointer that holds
the individuals that make up the population.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AGENERATION-COUNTER-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L121">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AGENERATION-COUNTER-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" >GENERATION-COUNTER</a></span></span> <span class="locative-args">EVOLUTIONARY-ALGORITHM</span> <span class="locative-args">(= 0)</span></span></p>

<p>A counter that starts from 0 and is incremented by
<a href="#x-28MGL-GPR-3AADVANCE-20GENERIC-FUNCTION-29" title="(MGL-GPR:ADVANCE GENERIC-FUNCTION)"><code>ADVANCE</code></a>. All accessors of <a href="#x-28MGL-GPR-3AEVOLUTIONARY-ALGORITHM-20CLASS-29" title="(MGL-GPR:EVOLUTIONARY-ALGORITHM CLASS)"><code>EVOLUTIONARY-ALGORITHM</code></a> are allowed to be
specialized on a subclass which allows them to be functions of
<code>GENERATION-COUNTER</code>.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AADD-INDIVIDUAL-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L59">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AADD-INDIVIDUAL-20FUNCTION-29" >ADD-INDIVIDUAL</a></span></span> <span class="locative-args">EA INDIVIDUAL</span></span></p>

<p>Adds <code>INDIVIDUAL</code> to <a href="#x-28MGL-GPR-3APOPULATION-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" title="(MGL-GPR:POPULATION (MGL-PAX:ACCESSOR MGL-GPR:EVOLUTIONARY-ALGORITHM))"><code>POPULATION</code></a> of <code>EA</code>. Usually called when
initializing the <code>EA</code>.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3A-40GPR-EA-EVALUATION-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-EA-POPULATION-20MGL-PAX-3ASECTION-29" title="Populations">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-EA-20MGL-PAX-3ASECTION-29" title="Evolutionary Algorithms">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-EA-TRAINING-20MGL-PAX-3ASECTION-29" title="Training">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-EA-EVALUATION-20MGL-PAX-3ASECTION-29" title="Evaluation">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L64">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-GPR-3A-40GPR-EA-EVALUATION-20MGL-PAX-3ASECTION-29">4.2 Evaluation</a></h3>

<p><a id='x-28MGL-GPR-3AEVALUATOR-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L85">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AEVALUATOR-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" >EVALUATOR</a></span></span> <span class="locative-args">EVOLUTIONARY-ALGORITHM</span> <span class="locative-args">(:EVALUATOR)</span></span></p>

<p>A function of two arguments: the
<a href="#x-28MGL-GPR-3AEVOLUTIONARY-ALGORITHM-20CLASS-29" title="(MGL-GPR:EVOLUTIONARY-ALGORITHM CLASS)"><code>EVOLUTIONARY-ALGORITHM</code></a> object and an individual. It must return
the fitness of the individual. For <a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29" title="Genetic Programming">Genetic Programming</a>, the evaluator often
simply calls <code>EVAL</code>, or <code>COMPILE</code> + <code>FUNCALL</code>, and compares the result
to some gold standard. It is also typical to slightly penalize
solutions with too many nodes to control complexity and evaluation
cost (see <a href="#x-28MGL-GPR-3ACOUNT-NODES-20FUNCTION-29" title="(MGL-GPR:COUNT-NODES FUNCTION)"><code>COUNT-NODES</code></a>). For <a href="#x-28MGL-GPR-3A-40GPR-DE-20MGL-PAX-3ASECTION-29" title="Differential Evolution">Differential Evolution</a>, individuals are
conceptually (and often implemented as) vectors of numbers so the
fitness function may include an L1 or L2 penalty term.</p>

<p>Alternatively, one can specify <a href="#x-28MGL-GPR-3AMASS-EVALUATOR-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" title="(MGL-GPR:MASS-EVALUATOR (MGL-PAX:READER MGL-GPR:EVOLUTIONARY-ALGORITHM))"><code>MASS-EVALUATOR</code></a> instead.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AMASS-EVALUATOR-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L99">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AMASS-EVALUATOR-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" >MASS-EVALUATOR</a></span></span> <span class="locative-args">EVOLUTIONARY-ALGORITHM</span> <span class="locative-args">(:MASS-EVALUATOR = <code>NIL</code>)</span></span></p>

<p><code>NIL</code> or a function of three arguments: the
<a href="#x-28MGL-GPR-3AEVOLUTIONARY-ALGORITHM-20CLASS-29" title="(MGL-GPR:EVOLUTIONARY-ALGORITHM CLASS)"><code>EVOLUTIONARY-ALGORITHM</code></a> object, the population vector and the
fitness vector into which the fitnesses of the individuals in the
population vector shall be written. By specifying <code>MASS-EVALUATOR</code>
instead of an <a href="#x-28MGL-GPR-3AEVALUATOR-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" title="(MGL-GPR:EVALUATOR (MGL-PAX:READER MGL-GPR:EVOLUTIONARY-ALGORITHM))"><code>EVALUATOR</code></a>, one can, for example, distribute costly
evaluations over multiple threads. <code>MASS-EVALUATOR</code> has precedence
over <a href="#x-28MGL-GPR-3AEVALUATOR-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" title="(MGL-GPR:EVALUATOR (MGL-PAX:READER MGL-GPR:EVOLUTIONARY-ALGORITHM))"><code>EVALUATOR</code></a>.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AFITNESS-KEY-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L110">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AFITNESS-KEY-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" >FITNESS-KEY</a></span></span> <span class="locative-args">EVOLUTIONARY-ALGORITHM</span> <span class="locative-args">(:FITNESS-KEY = #'<code>IDENTITY</code>)</span></span></p>

<p>A function that returns a real number for an
object returned by <a href="#x-28MGL-GPR-3AEVALUATOR-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" title="(MGL-GPR:EVALUATOR (MGL-PAX:READER MGL-GPR:EVOLUTIONARY-ALGORITHM))"><code>EVALUATOR</code></a>. It is called when two fitness are to
be compared. The default value is #'<code>IDENTITY</code> which is sufficient
when <a href="#x-28MGL-GPR-3AEVALUATOR-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" title="(MGL-GPR:EVALUATOR (MGL-PAX:READER MGL-GPR:EVOLUTIONARY-ALGORITHM))"><code>EVALUATOR</code></a> returns real numbers. However, sometimes the
evaluator returns more information about the solution (such as
fitness in various situations) and <code>FITNESS-KEY</code> key be used to
select the fitness value.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3A-40GPR-EA-TRAINING-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-EA-EVALUATION-20MGL-PAX-3ASECTION-29" title="Evaluation">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-EA-20MGL-PAX-3ASECTION-29" title="Evolutionary Algorithms">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29" title="Genetic Programming">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-EA-TRAINING-20MGL-PAX-3ASECTION-29" title="Training">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L69">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-GPR-3A-40GPR-EA-TRAINING-20MGL-PAX-3ASECTION-29">4.3 Training</a></h3>

<p>Training is easy: one creates an object of a subclass of
<a href="#x-28MGL-GPR-3AEVOLUTIONARY-ALGORITHM-20CLASS-29" title="(MGL-GPR:EVOLUTIONARY-ALGORITHM CLASS)"><code>EVOLUTIONARY-ALGORITHM</code></a> such as <a href="#x-28MGL-GPR-3AGENETIC-PROGRAMMING-20CLASS-29" title="(MGL-GPR:GENETIC-PROGRAMMING CLASS)"><code>GENETIC-PROGRAMMING</code></a> or
<a href="#x-28MGL-GPR-3ADIFFERENTIAL-EVOLUTION-20CLASS-29" title="(MGL-GPR:DIFFERENTIAL-EVOLUTION CLASS)"><code>DIFFERENTIAL-EVOLUTION</code></a>, creates the initial population by adding
individuals to it (see <a href="#x-28MGL-GPR-3AADD-INDIVIDUAL-20FUNCTION-29" title="(MGL-GPR:ADD-INDIVIDUAL FUNCTION)"><code>ADD-INDIVIDUAL</code></a>) and calls <a href="#x-28MGL-GPR-3AADVANCE-20GENERIC-FUNCTION-29" title="(MGL-GPR:ADVANCE GENERIC-FUNCTION)"><code>ADVANCE</code></a> in a loop
to move on to the next generation until a certain number of
generations or until the <a href="#x-28MGL-GPR-3AFITTEST-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" title="(MGL-GPR:FITTEST (MGL-PAX:READER MGL-GPR:EVOLUTIONARY-ALGORITHM))"><code>FITTEST</code></a> individual is good enough.</p>

<p><a id='x-28MGL-GPR-3AADVANCE-20GENERIC-FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L80">[generic-function]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AADVANCE-20GENERIC-FUNCTION-29" >ADVANCE</a></span></span> <span class="locative-args">EA</span></span></p>

<p>Create the next generation and place it in
<a href="#x-28MGL-GPR-3APOPULATION-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" title="(MGL-GPR:POPULATION (MGL-PAX:ACCESSOR MGL-GPR:EVOLUTIONARY-ALGORITHM))"><code>POPULATION</code></a> of <code>EA</code>.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AFITTEST-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L135">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AFITTEST-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" >FITTEST</a></span></span> <span class="locative-args">EVOLUTIONARY-ALGORITHM</span> <span class="locative-args">(= <code>NIL</code>)</span></span></p>

<p>The fittest individual ever to be seen and its
fittness as a cons cell.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AFITTEST-CHANGED-FN-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/evolutionary-algorithm.lisp#L140">[accessor]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AFITTEST-CHANGED-FN-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" >FITTEST-CHANGED-FN</a></span></span> <span class="locative-args">EVOLUTIONARY-ALGORITHM</span> <span class="locative-args">(:FITTEST-CHANGED-FN = <code>NIL</code>)</span></span></p>

<p>If non-NIL, a function that's called when <a href="#x-28MGL-GPR-3AFITTEST-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" title="(MGL-GPR:FITTEST (MGL-PAX:READER MGL-GPR:EVOLUTIONARY-ALGORITHM))"><code>FITTEST</code></a>
is updated with three arguments: the <a href="#x-28MGL-GPR-3AEVOLUTIONARY-ALGORITHM-20CLASS-29" title="(MGL-GPR:EVOLUTIONARY-ALGORITHM CLASS)"><code>EVOLUTIONARY-ALGORITHM</code></a>
object, the fittest individual and its fitness. Useful for
tracking progress.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-EA-TRAINING-20MGL-PAX-3ASECTION-29" title="Training">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-MANUAL-20MGL-PAX-3ASECTION-29" title="GPR Manual">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-BACKGROUND-20MGL-PAX-3ASECTION-29" title="Background">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29" title="Genetic Programming">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L3">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29">5 Genetic Programming</a></h2>

<p><a id='x-28MGL-GPR-3A-40GPR-GP-BACKGROUND-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29" title="Genetic Programming">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29" title="Genetic Programming">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-TUTORIAL-20MGL-PAX-3ASECTION-29" title="Tutorial">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-BACKGROUND-20MGL-PAX-3ASECTION-29" title="Background">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L12">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-GPR-3A-40GPR-GP-BACKGROUND-20MGL-PAX-3ASECTION-29">5.1 Background</a></h3>

<p>What is Genetic Programming? This is what Wikipedia has to say:</p>

<pre><code>In artificial intelligence, genetic programming (GP) is an
evolutionary algorithm-based methodology inspired by biological
evolution to find computer programs that perform a user-defined
task. Essentially GP is a set of instructions and a fitness
function to measure how well a computer has performed a task. It
is a specialization of genetic algorithms (GA) where each
individual is a computer program. It is a machine learning
technique used to optimize a population of computer programs
according to a fitness landscape determined by a program's ability
to perform a given computational task.
</code></pre>

<p>Lisp has a long history of Genetic Programming because GP involves
manipulation of expressions which is of course particularly easy
with sexps.</p>

<p><a id='x-28MGL-GPR-3A-40GPR-GP-TUTORIAL-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-GP-BACKGROUND-20MGL-PAX-3ASECTION-29" title="Background">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29" title="Genetic Programming">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-EXPRESSIONS-20MGL-PAX-3ASECTION-29" title="Expressions">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-TUTORIAL-20MGL-PAX-3ASECTION-29" title="Tutorial">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L30">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-GPR-3A-40GPR-GP-TUTORIAL-20MGL-PAX-3ASECTION-29">5.2 Tutorial</a></h3>

<p>GPR works with typed expressions. Mutation and crossover never
produce expressions that fail with a type error. Let's define a
couple of operators that work with real numbers and also return a
real:</p>

<pre><code>(defparameter *operators* (list (operator (+ real real) real)
                                (operator (- real real) real)
                                (operator (* real real) real)
                                (operator (sin real) real)))
</code></pre>

<p>One cannot build an expression out of these operators because they
all have at least one argument. Let's define some literal classes
too. The first is produces random numbers, the second always returns
the symbol <code>*X*</code>:</p>

<pre><code>(defparameter *literals* (list (literal (real)
                                 (- (random 32.0) 16.0))
                               (literal (real)
                                 '*x*)))
</code></pre>

<p>Armed with <code>*OPERATORS*</code> and <code>*LITERALS*</code>, one can already build
random expressions with <a href="#x-28MGL-GPR-3ARANDOM-EXPRESSION-20FUNCTION-29" title="(MGL-GPR:RANDOM-EXPRESSION FUNCTION)"><code>RANDOM-EXPRESSION</code></a>, but we also need to
define how good a certain expression is which is called <em>fitness</em>.</p>

<p>In this example, we are going to perform symbolic regression, that
is, try to find an expression that approximates some target
expression well:</p>

<pre><code>(defparameter *target-expr* '(+ 7 (sin (expt (* *x* 2 pi) 2))))
</code></pre>

<p>Think of <code>*TARGET-EXPR*</code> as a function of <code>*X*</code>. The evaluator
function will bind the special <code>*X*</code> to the input and simply <code>EVAL</code>
the expression to be evaluated.</p>

<pre><code>(defvar *x*)
</code></pre>

<p>The evaluator function calculates the average difference between
<code>EXPR</code> and <code>TARGET-EXPR</code>, penalizes large expressions and returns
the fitness of <code>EXPR</code>. Expressions with higher fitness have higher
chance to produce offsprings.</p>

<pre><code>(defun evaluate (gp expr target-expr)
  (declare (ignore gp))
  (/ 1
     (1+
      ;; Calculate average difference from target.
      (/ (loop for x from 0d0 to 10d0 by 0.5d0
               summing (let ((*x* x))
                         (abs (- (eval expr)
                                 (eval target-expr)))))
         21))
     ;; Penalize large expressions.
     (let ((min-penalized-size 40)
           (size (count-nodes expr)))
       (if (&lt; size min-penalized-size)
           1
           (exp (min 120 (/ (- size min-penalized-size) 10d0)))))))
</code></pre>

<p>When an expression is to undergo mutation, a randomizer function is
called. Here we change literal numbers slightly, or produce an
entirely new random expression that will be substituted for <code>EXPR</code>:</p>

<pre><code>(defun randomize (gp type expr)
  (if (and (numberp expr)
           (&lt; (random 1.0) 0.5))
      (+ expr (random 1.0) -0.5)
      (random-gp-expression gp (lambda (level)
                                 (&lt;= 3 level))
                            :type type)))
</code></pre>

<p>That's about it. Now we create a GP instance hooking everything up,
set up the initial population and just call <a href="#x-28MGL-GPR-3AADVANCE-20GENERIC-FUNCTION-29" title="(MGL-GPR:ADVANCE GENERIC-FUNCTION)"><code>ADVANCE</code></a> a couple of
times to create new generations of expressions.</p>

<pre><code>(defun run ()
  (let ((*print-length* nil)
        (*print-level* nil)
        (gp (make-instance
             'gp
             :toplevel-type 'real
             :operators *operators*
             :literals *literals*
             :population-size 1000
             :copy-chance 0.0
             :mutation-chance 0.5
             :evaluator (lambda (gp expr)
                          (evaluate gp expr *target-expr*))
             :randomizer 'randomize
             :selector (lambda (gp fitnesses)
                         (declare (ignore gp))
                         (hold-tournament fitnesses :n-contestants 2))
             :fittest-changed-fn
             (lambda (gp fittest fitness)
               (format t &quot;Best fitness until generation ~S: ~S for~%  ~S~%&quot;
                       (generation-counter gp) fitness fittest)))))
    (loop repeat (population-size gp) do
      (add-individual gp (random-gp-expression gp (lambda (level)
                                                    (&lt;= 5 level)))))
    (loop repeat 1000 do
      (when (zerop (mod (generation-counter gp) 20))
        (format t &quot;Generation ~S~%&quot; (generation-counter gp)))
      (advance gp))
    (destructuring-bind (fittest . fitness) (fittest gp)
      (format t &quot;Best fitness: ~S for~%  ~S~%&quot; fitness fittest))))
</code></pre>

<p>Note that this example can be found in
example/symbolic-regression.lisp.</p>

<p><a id='x-28MGL-GPR-3A-40GPR-GP-EXPRESSIONS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-GP-TUTORIAL-20MGL-PAX-3ASECTION-29" title="Tutorial">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29" title="Genetic Programming">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-BASICS-20MGL-PAX-3ASECTION-29" title="Basics">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-EXPRESSIONS-20MGL-PAX-3ASECTION-29" title="Expressions">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L139">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-GPR-3A-40GPR-GP-EXPRESSIONS-20MGL-PAX-3ASECTION-29">5.3 Expressions</a></h3>

<p>Genetic programming works with a population of individuals. The
individuals are sexps that may be evaluated directly by <code>EVAL</code> or by
other means. The internal nodes and the leafs of the sexp as a tree
represent the application of operators and literal objects,
respectively. Note that currently there is no way to represent
literal lists.</p>

<p><a id='x-28MGL-GPR-3AEXPRESSION-CLASS-20CLASS-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L158">[class]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AEXPRESSION-CLASS-20CLASS-29" >EXPRESSION-CLASS</a></span></span></span></p>

<p>An object of <code>EXPRESSION-CLASS</code> defines two things:
how to build a random expression that belongs to that expression
class and what lisp type those expressions evaluate to.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ARESULT-TYPE-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEXPRESSION-CLASS-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L159">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ARESULT-TYPE-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEXPRESSION-CLASS-29-29" >RESULT-TYPE</a></span></span> <span class="locative-args">EXPRESSION-CLASS</span> <span class="locative-args">(:RESULT-TYPE)</span></span></p>

<p>Expressions belonging to this expression class
must evaluate to a value of this lisp type.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AWEIGHT-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEXPRESSION-CLASS-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L164">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AWEIGHT-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEXPRESSION-CLASS-29-29" >WEIGHT</a></span></span> <span class="locative-args">EXPRESSION-CLASS</span> <span class="locative-args">(:WEIGHT = 1)</span></span></p>

<p>The probability of an expression class to be
selected from a set of candidates is proportional to its
weight.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AOPERATOR-20CLASS-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L178">[class]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AOPERATOR-20CLASS-29" >OPERATOR</a></span></span> <span class="locative-args"><a href="#x-28MGL-GPR-3AEXPRESSION-CLASS-20CLASS-29" title="(MGL-GPR:EXPRESSION-CLASS CLASS)">EXPRESSION-CLASS</a></span></span></p>

<p>Defines how the symbol <a href="#x-28MGL-GPR-3ANAME-20-28MGL-PAX-3AREADER-20MGL-GPR-3AOPERATOR-29-29" title="(MGL-GPR:NAME (MGL-PAX:READER MGL-GPR:OPERATOR))"><code>NAME</code></a> in the function
position of a list can be combined arguments: how many and of what
types. The following defines <code>+</code> as an operator that adds two
<code>FLOAT</code>s:</p>

<pre><code>(make-instance 'operator 
               :name '+
               :result-type float
               :argument-types '(float float))
</code></pre>

<p>See the macro <a href="#x-28MGL-GPR-3AOPERATOR-20MGL-PAX-3AMACRO-29" title="(MGL-GPR:OPERATOR MGL-PAX:MACRO)"><code>OPERATOR</code></a> for a shorthand for the above.</p>

<p>Currently no lambda list keywords are supported and there is no way
to define how an expression with a particular operator is to be
built. See <a href="#x-28MGL-GPR-3ARANDOM-EXPRESSION-20FUNCTION-29" title="(MGL-GPR:RANDOM-EXPRESSION FUNCTION)"><code>RANDOM-EXPRESSION</code></a>.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ANAME-20-28MGL-PAX-3AREADER-20MGL-GPR-3AOPERATOR-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L179">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ANAME-20-28MGL-PAX-3AREADER-20MGL-GPR-3AOPERATOR-29-29" >NAME</a></span></span> <span class="locative-args">OPERATOR</span> <span class="locative-args">(:NAME)</span></span></p>

<p>A symbol that's the name of the operator.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AARGUMENT-TYPES-20-28MGL-PAX-3AREADER-20MGL-GPR-3AOPERATOR-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L183">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AARGUMENT-TYPES-20-28MGL-PAX-3AREADER-20MGL-GPR-3AOPERATOR-29-29" >ARGUMENT-TYPES</a></span></span> <span class="locative-args">OPERATOR</span> <span class="locative-args">(:ARGUMENT-TYPES)</span></span></p>

<p>A list of lisp types. One for each argument of
this operator.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AOPERATOR-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L209">[macro]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AOPERATOR-20MGL-PAX-3AMACRO-29" >OPERATOR</a></span></span> <span class="locative-args">(NAME &amp;REST ARG-TYPES) RESULT-TYPE &amp;KEY (WEIGHT 1)</span></span></p>

<p>Syntactic sugar for instantiating operators. The example given for
<a href="#x-28MGL-GPR-3AOPERATOR-20CLASS-29" title="(MGL-GPR:OPERATOR CLASS)"><code>OPERATOR</code></a> could be written as:</p>

<pre><code>(operator (+ float float) float)
</code></pre>

<p>See <a href="#x-28MGL-GPR-3AWEIGHT-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEXPRESSION-CLASS-29-29" title="(MGL-GPR:WEIGHT (MGL-PAX:READER MGL-GPR:EXPRESSION-CLASS))"><code>WEIGHT</code></a> for what <code>WEIGHT</code> means.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ALITERAL-20CLASS-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L220">[class]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ALITERAL-20CLASS-29" >LITERAL</a></span></span> <span class="locative-args"><a href="#x-28MGL-GPR-3AEXPRESSION-CLASS-20CLASS-29" title="(MGL-GPR:EXPRESSION-CLASS CLASS)">EXPRESSION-CLASS</a></span></span></p>

<p>This is slightly misnamed. An object belonging to
the <a href="#x-28MGL-GPR-3ALITERAL-20CLASS-29" title="(MGL-GPR:LITERAL CLASS)"><code>LITERAL</code></a> class is not a literal itself, it's a factory for
literals via its <a href="#x-28MGL-GPR-3ABUILDER-20-28MGL-PAX-3AREADER-20MGL-GPR-3ALITERAL-29-29" title="(MGL-GPR:BUILDER (MGL-PAX:READER MGL-GPR:LITERAL))"><code>BUILDER</code></a> function. For example, the following
literal builds bytes:</p>

<pre><code>(make-instance 'literal
               :result-type '(unsigned-byte 8)
               :builder (lambda () (random 256)))
</code></pre>

<p>In practice, one rarely writes it out like that, because the <a href="#x-28MGL-GPR-3ALITERAL-20MGL-PAX-3AMACRO-29" title="(MGL-GPR:LITERAL MGL-PAX:MACRO)"><code>LITERAL</code></a>
macro provides a more convenient shorthand.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ABUILDER-20-28MGL-PAX-3AREADER-20MGL-GPR-3ALITERAL-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L221">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ABUILDER-20-28MGL-PAX-3AREADER-20MGL-GPR-3ALITERAL-29-29" >BUILDER</a></span></span> <span class="locative-args">LITERAL</span> <span class="locative-args">(:BUILDER)</span></span></p>

<p>A function of no arguments that returns a random
literal that belongs to its literal class.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ALITERAL-20MGL-PAX-3AMACRO-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L242">[macro]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ALITERAL-20MGL-PAX-3AMACRO-29" >LITERAL</a></span></span> <span class="locative-args">(RESULT-TYPE &amp;KEY (WEIGHT 1)) &amp;BODY BODY</span></span></p>

<p>Syntactic sugar for defining literal classes. The example given for
<a href="#x-28MGL-GPR-3ALITERAL-20CLASS-29" title="(MGL-GPR:LITERAL CLASS)"><code>LITERAL</code></a> could be written as:</p>

<pre><code>(literal ((unsigned-byte 8))
  (random 256))
</code></pre>

<p>See <a href="#x-28MGL-GPR-3AWEIGHT-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEXPRESSION-CLASS-29-29" title="(MGL-GPR:WEIGHT (MGL-PAX:READER MGL-GPR:EXPRESSION-CLASS))"><code>WEIGHT</code></a> for what <code>WEIGHT</code> means.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ARANDOM-EXPRESSION-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L254">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ARANDOM-EXPRESSION-20FUNCTION-29" >RANDOM-EXPRESSION</a></span></span> <span class="locative-args">OPERATORS LITERALS TYPE TERMINATE-FN</span></span></p>

<p>Return an expression built from <code>OPERATORS</code> and <code>LITERALS</code> that
evaluates to values of <code>TYPE</code>. <code>TERMINATE-FN</code> is a function of one
argument: the level of the root of the subexpression to be generated
in the context of the entire expression. If it returns <code>T</code> then a
<a href="#x-28MGL-GPR-3ALITERAL-20CLASS-29" title="(MGL-GPR:LITERAL CLASS)"><code>LITERAL</code></a> will be inserted (by calling its <a href="#x-28MGL-GPR-3ABUILDER-20-28MGL-PAX-3AREADER-20MGL-GPR-3ALITERAL-29-29" title="(MGL-GPR:BUILDER (MGL-PAX:READER MGL-GPR:LITERAL))"><code>BUILDER</code></a> function),
else an <a href="#x-28MGL-GPR-3AOPERATOR-20CLASS-29" title="(MGL-GPR:OPERATOR CLASS)"><code>OPERATOR</code></a> with all its necessary arguments.</p>

<p>The algorithm recursively generates the expression starting from
level 0 where only operators and literals with a <a href="#x-28MGL-GPR-3ARESULT-TYPE-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEXPRESSION-CLASS-29-29" title="(MGL-GPR:RESULT-TYPE (MGL-PAX:READER MGL-GPR:EXPRESSION-CLASS))"><code>RESULT-TYPE</code></a> that's
a subtype of <code>TYPE</code> are considered and one is selected with the
unnormalized probability given by its <a href="#x-28MGL-GPR-3AWEIGHT-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEXPRESSION-CLASS-29-29" title="(MGL-GPR:WEIGHT (MGL-PAX:READER MGL-GPR:EXPRESSION-CLASS))"><code>WEIGHT</code></a>. On lower levels, the
<a href="#x-28MGL-GPR-3AARGUMENT-TYPES-20-28MGL-PAX-3AREADER-20MGL-GPR-3AOPERATOR-29-29" title="(MGL-GPR:ARGUMENT-TYPES (MGL-PAX:READER MGL-GPR:OPERATOR))"><code>ARGUMENT-TYPES</code></a> specification of operators is similarly satisfied and
the resulting expression should evaluate without without a type
error.</p>

<p>The building of expressions cannot backtrack. If it finds itself in
a situation where no literals or operators of the right type are
available then it will fail with an error.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3A-40GPR-GP-BASICS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-GP-EXPRESSIONS-20MGL-PAX-3ASECTION-29" title="Expressions">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29" title="Genetic Programming">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-SEARCH-SPACE-20MGL-PAX-3ASECTION-29" title="Search Space">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-BASICS-20MGL-PAX-3ASECTION-29" title="Basics">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L299">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-GPR-3A-40GPR-GP-BASICS-20MGL-PAX-3ASECTION-29">5.4 Basics</a></h3>

<p>To start the evolutionary process one creates a GP object,
adds to it the individuals (see <a href="#x-28MGL-GPR-3AADD-INDIVIDUAL-20FUNCTION-29" title="(MGL-GPR:ADD-INDIVIDUAL FUNCTION)"><code>ADD-INDIVIDUAL</code></a>) that make up the
initial population and calls <a href="#x-28MGL-GPR-3AADVANCE-20GENERIC-FUNCTION-29" title="(MGL-GPR:ADVANCE GENERIC-FUNCTION)"><code>ADVANCE</code></a> in a loop to move on to the
next generation.</p>

<p><a id='x-28MGL-GPR-3AGENETIC-PROGRAMMING-20CLASS-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L307">[class]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AGENETIC-PROGRAMMING-20CLASS-29" >GENETIC-PROGRAMMING</a></span></span> <span class="locative-args"><a href="#x-28MGL-GPR-3AEVOLUTIONARY-ALGORITHM-20CLASS-29" title="(MGL-GPR:EVOLUTIONARY-ALGORITHM CLASS)">EVOLUTIONARY-ALGORITHM</a></span></span></p>

<p>The <code>GENETIC-PROGRAMMING</code> class defines the search
space, how mutation and recombination occur, and hold various
parameters of the evolutionary process and the individuals
themselves.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ARANDOM-GP-EXPRESSION-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L368">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ARANDOM-GP-EXPRESSION-20FUNCTION-29" >RANDOM-GP-EXPRESSION</a></span></span> <span class="locative-args">GP TERMINATE-FN &amp;KEY (TYPE (<a href="#x-28MGL-GPR-3ATOPLEVEL-TYPE-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" title="(MGL-GPR:TOPLEVEL-TYPE (MGL-PAX:READER MGL-GPR:GENETIC-PROGRAMMING))"><code>TOPLEVEL-TYPE</code></a> GP))</span></span></p>

<p>Creating the initial population by hand is tedious. This
convenience function calls <a href="#x-28MGL-GPR-3ARANDOM-EXPRESSION-20FUNCTION-29" title="(MGL-GPR:RANDOM-EXPRESSION FUNCTION)"><code>RANDOM-EXPRESSION</code></a> to create a random
individual that produces <code>GP</code>'s <a href="#x-28MGL-GPR-3ATOPLEVEL-TYPE-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" title="(MGL-GPR:TOPLEVEL-TYPE (MGL-PAX:READER MGL-GPR:GENETIC-PROGRAMMING))"><code>TOPLEVEL-TYPE</code></a>. By passing in another
<code>TYPE</code> one can create expressions that fit somewhere else in a larger
expression which is useful in a <a href="#x-28MGL-GPR-3ARANDOMIZER-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" title="(MGL-GPR:RANDOMIZER (MGL-PAX:READER MGL-GPR:GENETIC-PROGRAMMING))"><code>RANDOMIZER</code></a> function.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3A-40GPR-GP-SEARCH-SPACE-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-GP-BASICS-20MGL-PAX-3ASECTION-29" title="Basics">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29" title="Genetic Programming">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-REPRODUCTION-20MGL-PAX-3ASECTION-29" title="Reproduction">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-SEARCH-SPACE-20MGL-PAX-3ASECTION-29" title="Search Space">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L382">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-GPR-3A-40GPR-GP-SEARCH-SPACE-20MGL-PAX-3ASECTION-29">5.5 Search Space</a></h3>

<p>The search space of the GP is defined by the available operators,
literals and the type of the final result produced. The evaluator
function acts as the guiding light.</p>

<p><a id='x-28MGL-GPR-3AOPERATORS-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L308">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AOPERATORS-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" >OPERATORS</a></span></span> <span class="locative-args">GENETIC-PROGRAMMING</span> <span class="locative-args">(:OPERATORS)</span></span></p>

<p>The set of <a href="#x-28MGL-GPR-3AOPERATOR-20CLASS-29" title="(MGL-GPR:OPERATOR CLASS)"><code>OPERATOR</code></a>s from which (together
with <a href="#x-28MGL-GPR-3ALITERAL-20CLASS-29" title="(MGL-GPR:LITERAL CLASS)"><code>LITERAL</code></a>s) individuals are built.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ALITERALS-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L313">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ALITERALS-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" >LITERALS</a></span></span> <span class="locative-args">GENETIC-PROGRAMMING</span> <span class="locative-args">(:LITERALS)</span></span></p>

<p>The set of <a href="#x-28MGL-GPR-3ALITERAL-20CLASS-29" title="(MGL-GPR:LITERAL CLASS)"><code>LITERAL</code></a>s from which (together
with <a href="#x-28MGL-GPR-3AOPERATOR-20CLASS-29" title="(MGL-GPR:OPERATOR CLASS)"><code>OPERATOR</code></a>s) individuals are built.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ATOPLEVEL-TYPE-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L318">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ATOPLEVEL-TYPE-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" >TOPLEVEL-TYPE</a></span></span> <span class="locative-args">GENETIC-PROGRAMMING</span> <span class="locative-args">(:TOPLEVEL-TYPE = <code>T</code>)</span></span></p>

<p>The type of the results produced by individuals.
If the problem is to find the minimum a 1d real function then this
may be the symbol <code>REAL</code>. If the problem is to find the shortest
route, then this may be a vector. It all depends on the
representation of the problem, the operators and the literals.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ACOUNT-NODES-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/tree.lisp#L16">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ACOUNT-NODES-20FUNCTION-29" >COUNT-NODES</a></span></span> <span class="locative-args">TREE &amp;KEY INTERNAL</span></span></p>

<p>Count the nodes in the sexp <code>TREE</code>. If <code>INTERNAL</code> then don't count the
leaves.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3A-40GPR-GP-REPRODUCTION-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-GP-SEARCH-SPACE-20MGL-PAX-3ASECTION-29" title="Search Space">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29" title="Genetic Programming">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-ENVIRONMENT-20MGL-PAX-3ASECTION-29" title="Environment">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-REPRODUCTION-20MGL-PAX-3ASECTION-29" title="Reproduction">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L391">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-GPR-3A-40GPR-GP-REPRODUCTION-20MGL-PAX-3ASECTION-29">5.6 Reproduction</a></h3>

<p>The <a href="#x-28MGL-GPR-3ARANDOMIZER-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" title="(MGL-GPR:RANDOMIZER (MGL-PAX:READER MGL-GPR:GENETIC-PROGRAMMING))"><code>RANDOMIZER</code></a> and <a href="#x-28MGL-GPR-3ASELECTOR-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" title="(MGL-GPR:SELECTOR (MGL-PAX:READER MGL-GPR:GENETIC-PROGRAMMING))"><code>SELECTOR</code></a> functions define how mutation and
recombination occur.</p>

<p><a id='x-28MGL-GPR-3ARANDOMIZER-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L327">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ARANDOMIZER-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" >RANDOMIZER</a></span></span> <span class="locative-args">GENETIC-PROGRAMMING</span> <span class="locative-args">(:RANDOMIZER)</span></span></p>

<p>Used for mutations, this is a function of three
arguments: the GP object, the type the expression must produce and
current expression to be replaced with the returned value. It is
called with subexpressions of individuals.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ASELECTOR-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L334">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ASELECTOR-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" >SELECTOR</a></span></span> <span class="locative-args">GENETIC-PROGRAMMING</span> <span class="locative-args">(:SELECTOR)</span></span></p>

<p>A function of two arguments: the GP object and a
vector of fitnesses. It must return the and index into the fitness
vector. The individual whose fitness was thus selected will be
selected for reproduction be it copying, mutation or crossover.
Typically, this defers to <a href="#x-28MGL-GPR-3AHOLD-TOURNAMENT-20FUNCTION-29" title="(MGL-GPR:HOLD-TOURNAMENT FUNCTION)"><code>HOLD-TOURNAMENT</code></a>.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AHOLD-TOURNAMENT-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L536">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AHOLD-TOURNAMENT-20FUNCTION-29" >HOLD-TOURNAMENT</a></span></span> <span class="locative-args">FITNESSES &amp;KEY SELECT-CONTESTANT-FN N-CONTESTANTS KEY</span></span></p>

<p>Select <code>N-CONTESTANTS</code> (all different) for the tournament randomly,
represented by indices into <code>FITNESSES</code> and return the one with the
highest fitness. If <code>SELECT-CONTESTANT-FN</code> is <code>NIL</code> then contestants are
selected randomly with uniform probability. If <code>SELECT-CONTESTANT-FN</code>
is a function, then it's called with <code>FITNESSES</code> to return an
index (that may or may not be already selected for the tournament).
Specifying <code>SELECT-CONTESTANT-FN</code> allows one to conduct 'local'
tournaments biased towards a particular region of the index range.
<code>KEY</code> is <code>NIL</code> or a function that select the real fitness value from
elements of <code>FITNESSES</code>.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3A-40GPR-GP-ENVIRONMENT-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-GP-REPRODUCTION-20MGL-PAX-3ASECTION-29" title="Reproduction">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-20MGL-PAX-3ASECTION-29" title="Genetic Programming">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-DE-20MGL-PAX-3ASECTION-29" title="Differential Evolution">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-GP-ENVIRONMENT-20MGL-PAX-3ASECTION-29" title="Environment">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L398">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-GPR-3A-40GPR-GP-ENVIRONMENT-20MGL-PAX-3ASECTION-29">5.7 Environment</a></h3>

<p>The new generation is created by applying a reproduction operator
until <a href="#x-28MGL-GPR-3APOPULATION-SIZE-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" title="(MGL-GPR:POPULATION-SIZE (MGL-PAX:ACCESSOR MGL-GPR:EVOLUTIONARY-ALGORITHM))"><code>POPULATION-SIZE</code></a> is reached in the new generation. At each
step, a reproduction operator is randomly chosen.</p>

<p><a id='x-28MGL-GPR-3ACOPY-CHANCE-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L342">[accessor]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ACOPY-CHANCE-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" >COPY-CHANCE</a></span></span> <span class="locative-args">GENETIC-PROGRAMMING</span> <span class="locative-args">(:COPY-CHANCE = 0)</span></span></p>

<p>The probability of the copying reproduction
operator being chosen. Copying simply creates an exact copy of a
single individual.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AMUTATION-CHANCE-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L349">[accessor]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AMUTATION-CHANCE-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" >MUTATION-CHANCE</a></span></span> <span class="locative-args">GENETIC-PROGRAMMING</span> <span class="locative-args">(:MUTATION-CHANCE = 0)</span></span></p>

<p>The probability of the mutation reproduction
operator being chosen. Mutation creates a randomly altered copy of
an individual. See <a href="#x-28MGL-GPR-3ARANDOMIZER-20-28MGL-PAX-3AREADER-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" title="(MGL-GPR:RANDOMIZER (MGL-PAX:READER MGL-GPR:GENETIC-PROGRAMMING))"><code>RANDOMIZER</code></a>.</p></li>
</ul>

<p>If neither copying nor mutation were chosen, then a crossover will
take place.</p>

<p><a id='x-28MGL-GPR-3AKEEP-FITTEST-P-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/genetic-programming.lisp#L356">[accessor]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AKEEP-FITTEST-P-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AGENETIC-PROGRAMMING-29-29" >KEEP-FITTEST-P</a></span></span> <span class="locative-args">GENETIC-PROGRAMMING</span> <span class="locative-args">(:KEEP-FITTEST-P = <code>T</code>)</span></span></p>

<p>If true, then the fittest individual is always
copied without mutation to the next generation. Of course, it may
also have other offsprings.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3A-40GPR-DE-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-GP-ENVIRONMENT-20MGL-PAX-3ASECTION-29" title="Environment">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-MANUAL-20MGL-PAX-3ASECTION-29" title="GPR Manual">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-DE-SANSDE-20MGL-PAX-3ASECTION-29" title="SANSDE">&#8594;</a> <a href="#x-28MGL-GPR-3A-40GPR-DE-20MGL-PAX-3ASECTION-29" title="Differential Evolution">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/differential-evolution.lisp#L3">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-GPR-3A-40GPR-DE-20MGL-PAX-3ASECTION-29">6 Differential Evolution</a></h2>

<p>The concepts in this section are covered by <a href="http://107.167.189.191/~piak/teaching/ec/ec2012/das-de-sota-2011.pdf" >Differential
Evolution: A Survey of the State-of-the-Art</a>.</p>

<p><a id='x-28MGL-GPR-3ADIFFERENTIAL-EVOLUTION-20CLASS-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/differential-evolution.lisp#L20">[class]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ADIFFERENTIAL-EVOLUTION-20CLASS-29" >DIFFERENTIAL-EVOLUTION</a></span></span> <span class="locative-args"><a href="#x-28MGL-GPR-3AEVOLUTIONARY-ALGORITHM-20CLASS-29" title="(MGL-GPR:EVOLUTIONARY-ALGORITHM CLASS)">EVOLUTIONARY-ALGORITHM</a></span></span></p>

<p>Differential evolution (DE) is an evolutionary
algorithm in which individuals are represented by vectors of
numbers. New individuals are created by taking linear combinations
or by randomly swapping some of these numbers between two
individuals.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AMAP-WEIGHTS-INTO-FN-20-28MGL-PAX-3AREADER-20MGL-GPR-3ADIFFERENTIAL-EVOLUTION-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/differential-evolution.lisp#L21">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AMAP-WEIGHTS-INTO-FN-20-28MGL-PAX-3AREADER-20MGL-GPR-3ADIFFERENTIAL-EVOLUTION-29-29" >MAP-WEIGHTS-INTO-FN</a></span></span> <span class="locative-args">DIFFERENTIAL-EVOLUTION</span> <span class="locative-args">(:MAP-WEIGHTS-INTO-FN = #'<code>MAP-INTO</code>)</span></span></p>

<p>The vector of numbers (the 'weights') are most
often stored in some kind of array. All individuals must have the
same number of weights, but the actual representation can be
anything as long as the function in this slot mimics the semantics
of <code>MAP-INTO</code> that's the default.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ACREATE-INDIVIDUAL-FN-20-28MGL-PAX-3AREADER-20MGL-GPR-3ADIFFERENTIAL-EVOLUTION-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/differential-evolution.lisp#L30">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ACREATE-INDIVIDUAL-FN-20-28MGL-PAX-3AREADER-20MGL-GPR-3ADIFFERENTIAL-EVOLUTION-29-29" >CREATE-INDIVIDUAL-FN</a></span></span> <span class="locative-args">DIFFERENTIAL-EVOLUTION</span> <span class="locative-args">(:CREATE-INDIVIDUAL-FN)</span></span></p>

<p>Holds a function of one argument, the DE, that
returns a new individual that needs not be initialized in any way.
Typically this just calls <code>MAKE-ARRAY</code>.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AMUTATE-FN-20-28MGL-PAX-3AREADER-20MGL-GPR-3ADIFFERENTIAL-EVOLUTION-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/differential-evolution.lisp#L36">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AMUTATE-FN-20-28MGL-PAX-3AREADER-20MGL-GPR-3ADIFFERENTIAL-EVOLUTION-29-29" >MUTATE-FN</a></span></span> <span class="locative-args">DIFFERENTIAL-EVOLUTION</span> <span class="locative-args">(:MUTATE-FN)</span></span></p>

<p>One of the supplied mutation functions:
<a href="#x-28MGL-GPR-3AMUTATE-2FRAND-2F1-20FUNCTION-29" title="(MGL-GPR:MUTATE/RAND/1 FUNCTION)"><code>MUTATE/RAND/1</code></a> <a href="#x-28MGL-GPR-3AMUTATE-2FBEST-2F1-20FUNCTION-29" title="(MGL-GPR:MUTATE/BEST/1 FUNCTION)"><code>MUTATE/BEST/1</code></a> <a href="#x-28MGL-GPR-3AMUTATE-2FCURRENT-TO-BEST-2F2-20FUNCTION-29" title="(MGL-GPR:MUTATE/CURRENT-TO-BEST/2 FUNCTION)"><code>MUTATE/CURRENT-TO-BEST/2</code></a>.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ACROSSOVER-FN-20-28MGL-PAX-3AREADER-20MGL-GPR-3ADIFFERENTIAL-EVOLUTION-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/differential-evolution.lisp#L41">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ACROSSOVER-FN-20-28MGL-PAX-3AREADER-20MGL-GPR-3ADIFFERENTIAL-EVOLUTION-29-29" >CROSSOVER-FN</a></span></span> <span class="locative-args">DIFFERENTIAL-EVOLUTION</span> <span class="locative-args">(:CROSSOVER-FN = #'<a href="#x-28MGL-GPR-3ACROSSOVER-2FBINARY-20FUNCTION-29" title="(MGL-GPR:CROSSOVER/BINARY FUNCTION)"><code>CROSSOVER/BINARY</code></a>)</span></span></p>

<p>A function of three arguments, the DE and two
individuals, that destructively modifies the second individual by
using some parts of the first one. Currently, the implemented
crossover function is <a href="#x-28MGL-GPR-3ACROSSOVER-2FBINARY-20FUNCTION-29" title="(MGL-GPR:CROSSOVER/BINARY FUNCTION)"><code>CROSSOVER/BINARY</code></a>.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3AMUTATE-2FRAND-2F1-20FUNCTION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/differential-evolution.lisp#L155">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AMUTATE-2FRAND-2F1-20FUNCTION-29" >MUTATE/RAND/1</a></span></span> <span class="locative-args">DE CURRENT BEST POPULATION NURSERY &amp;KEY (F 0.5)</span></span></li>
</ul>

<p><a id='x-28MGL-GPR-3AMUTATE-2FBEST-2F1-20FUNCTION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/differential-evolution.lisp#L167">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AMUTATE-2FBEST-2F1-20FUNCTION-29" >MUTATE/BEST/1</a></span></span> <span class="locative-args">DE CURRENT BEST POPULATION NURSERY &amp;KEY (F 0.5)</span></span></li>
</ul>

<p><a id='x-28MGL-GPR-3AMUTATE-2FCURRENT-TO-BEST-2F2-20FUNCTION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/differential-evolution.lisp#L178">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3AMUTATE-2FCURRENT-TO-BEST-2F2-20FUNCTION-29" >MUTATE/CURRENT-TO-BEST/2</a></span></span> <span class="locative-args">DE CURRENT BEST POPULATION NURSERY &amp;KEY (F 0.5)</span></span></li>
</ul>

<p><a id='x-28MGL-GPR-3ACROSSOVER-2FBINARY-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/differential-evolution.lisp#L127">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ACROSSOVER-2FBINARY-20FUNCTION-29" >CROSSOVER/BINARY</a></span></span> <span class="locative-args">DE INDIVIDUAL-1 INDIVIDUAL-2 &amp;KEY (CROSSOVER-RATE 0.5)</span></span></p>

<p>Destructively modify <code>INDIVIDUAL-2</code> by replacement each element with
a probability of 1 - <code>CROSSOVER-RATE</code> with the corresponding element
in <code>INDIVIDUAL-1</code>. At least one, element is changed. Return
<code>INDIVIDUAL-2</code>.</p></li>
</ul>

<p><a id='x-28MGL-GPR-3ASELECT-DISTINCT-RANDOM-NUMBERS-20FUNCTION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/differential-evolution.lisp#L326">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ASELECT-DISTINCT-RANDOM-NUMBERS-20FUNCTION-29" >SELECT-DISTINCT-RANDOM-NUMBERS</a></span></span> <span class="locative-args">TABOOS N LIMIT</span></span></li>
</ul>

<p><a id='x-28MGL-GPR-3A-40GPR-DE-SANSDE-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-GPR-3A-40GPR-DE-20MGL-PAX-3ASECTION-29" title="Differential Evolution">&#8592;</a> <a href="#x-28MGL-GPR-3A-40GPR-DE-20MGL-PAX-3ASECTION-29" title="Differential Evolution">&#8593;</a> <a href="#x-28MGL-GPR-3A-40GPR-DE-SANSDE-20MGL-PAX-3ASECTION-29" title="SANSDE">&#8634;</a> <a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/differential-evolution.lisp#L194">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-GPR-3A-40GPR-DE-SANSDE-20MGL-PAX-3ASECTION-29">6.1 SANSDE</a></h3>

<p><a id='x-28MGL-GPR-3ASANSDE-20CLASS-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-gpr/blob/c606f860a5993d4ec15b753fc0e238df1e133e3f/src/differential-evolution.lisp#L204">[class]</a></span> <span class="reference-object"><a href="#x-28MGL-GPR-3ASANSDE-20CLASS-29" >SANSDE</a></span></span> <span class="locative-args"><a href="#x-28MGL-GPR-3ADIFFERENTIAL-EVOLUTION-20CLASS-29" title="(MGL-GPR:DIFFERENTIAL-EVOLUTION CLASS)">DIFFERENTIAL-EVOLUTION</a></span></span></p>

<p>SaNSDE is a special DE that dynamically adjust the
crossover and mutation are performed. The only parameters are the
generic EA ones: <a href="#x-28MGL-GPR-3APOPULATION-SIZE-20-28MGL-PAX-3AACCESSOR-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" title="(MGL-GPR:POPULATION-SIZE (MGL-PAX:ACCESSOR MGL-GPR:EVOLUTIONARY-ALGORITHM))"><code>POPULATION-SIZE</code></a>, <a href="#x-28MGL-GPR-3AEVALUATOR-20-28MGL-PAX-3AREADER-20MGL-GPR-3AEVOLUTIONARY-ALGORITHM-29-29" title="(MGL-GPR:EVALUATOR (MGL-PAX:READER MGL-GPR:EVOLUTIONARY-ALGORITHM))"><code>EVALUATOR</code></a>, etc. One also has to
specify <a href="#x-28MGL-GPR-3AMAP-WEIGHTS-INTO-FN-20-28MGL-PAX-3AREADER-20MGL-GPR-3ADIFFERENTIAL-EVOLUTION-29-29" title="(MGL-GPR:MAP-WEIGHTS-INTO-FN (MGL-PAX:READER MGL-GPR:DIFFERENTIAL-EVOLUTION))"><code>MAP-WEIGHTS-INTO-FN</code></a> and <a href="#x-28MGL-GPR-3ACREATE-INDIVIDUAL-FN-20-28MGL-PAX-3AREADER-20MGL-GPR-3ADIFFERENTIAL-EVOLUTION-29-29" title="(MGL-GPR:CREATE-INDIVIDUAL-FN (MGL-PAX:READER MGL-GPR:DIFFERENTIAL-EVOLUTION))"><code>CREATE-INDIVIDUAL-FN</code></a>.</p></li>
</ul>
  </div>
</div>
<script>$('#page-toc').toc({'selectors': 'h1,h2,h3,h4'});</script>
</body>
</html>
